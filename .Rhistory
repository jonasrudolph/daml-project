ids_admin_jobs <- filtered_data$ID[filtered_data$Job.Title %in% admin_jobs2$Job.Title]
# Entferne die entsprechenden Zeilen aus filtered_data
filtered_data_neu <- filtered_data[!(filtered_data$ID %in% c(ids_technische_jobs, ids_admin_jobs)), ]
# Beispiel für die Ausgabe der ersten paar Zeilen der gefilterten Daten
head(filtered_data_neu)
anzahl_technische_jobs2 <- nrow(technische_jobs2)
cat("Anzahl der technischen Jobs2:", anzahl_technische_jobs2, "\n")
anzahl_admin_jobs2 <- nrow(admin_jobs2)
cat("Anzahl der administrativen Jobs2:", anzahl_admin_jobs2, "\n")
anzahl_technische_jobs2 <- nrow(technische_jobs2)
cat("Anzahl der technischen Jobs2:", anzahl_technische_jobs2, "\n")
anzahl_admin_jobs2 <- nrow(admin_jobs2)
cat("Anzahl der administrativen Jobs2:", anzahl_admin_jobs2, "\n")
# Erstellung der neuen Spalte "job_type" basierend auf den gegebenen Filtern
filtered_data$job_type <- ifelse(
grepl("data|engineer|developer|analyst|scientist", tolower(filtered_data$Job.Title)),
0, # 0 für technische Jobs
ifelse(
grepl("associate|director|manager|sales|coordinator|generalist", tolower(filtered_data$Job.Title)),
1, # 1 für administrative Jobs
NA  # NA für alle anderen
)
)
# Anzeige der Anzahl aller Zeilen im Datensatz und der Anzahl der Zeilen für jede job_type-Ausprägung
total_rows <- nrow(filtered_data)
count_job_types <- table(filtered_data$job_type, useNA = "ifany")
# Ausgabe der Ergebnisse
print(paste("Gesamtanzahl der Zeilen im Datensatz:", total_rows))
print("Anzahl der Zeilen für jede job_type-Ausprägung:")
print(count_job_types)
# Aktualisierung der job_type-Spalte für die spezifischen Job-Titel
filtered_data$job_type[filtered_data$Job.Title %in% c("Product Designer", "Receptionist")] <- 1
# Anzeige der aktualisierten Daten für die ausgewählten Job-Titel
subset(filtered_data, Job.Title %in% c("Product Designer", "Receptionist"))
# Anzeige der Anzahl aller Zeilen im Datensatz und der Anzahl der Zeilen für jede job_type-Ausprägung
total_rows <- nrow(filtered_data)
count_job_types <- table(filtered_data$job_type, useNA = "ifany")
# Ausgabe der Ergebnisse
print(paste("Gesamtanzahl der Zeilen im Datensatz:", total_rows))
print("Anzahl der Zeilen für jede job_type-Ausprägung:")
print(count_job_types)
ggplot(filtered_data, aes(x = factor(Gender), y = Years.Of.Experience, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Years of Experience vs. Gender",
x = "Gender",
y = "Years of Experience",
fill = "Gender") +
theme_minimal()
# Bibliothek ggplot2 laden
library(ggplot2)
# Daten für China filtern
data_china <- subset(filtered_data, Country == "China")
# Boxplot erstellen
ggplot(data_china, aes(x = factor(Gender), y = Years.Of.Experience, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Years of Experience vs. Gender (China)",
x = "Gender",
y = "Years of Experience",
fill = "Gender") +
theme_minimal()
# Bibliothek ggplot2 laden
library(ggplot2)
# Daten für China filtern
data_china <- subset(filtered_data, Country == "China")
# Boxplot für Salary vs. Gender erstellen
ggplot(data_china, aes(x = factor(Gender), y = Salary, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Salary vs. Gender (China)",
x = "Gender",
y = "Salary",
fill = "Gender") +
theme_minimal()
# Bibliothek ggplot2 laden
library(ggplot2)
# Daten für USA filtern
data_usa <- subset(filtered_data, Country == "USA")
# Boxplot erstellen
ggplot(data_usa, aes(x = factor(Gender), y = Years.Of.Experience, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Years of Experience vs. Gender (USA)",
x = "Gender",
y = "Years of Experience",
fill = "Gender") +
theme_minimal()
# Bibliothek ggplot2 laden
library(ggplot2)
# Daten für USA filtern
data_usa <- subset(filtered_data, Country == "USA")
# Boxplot für Salary vs. Gender erstellen
ggplot(data_usa, aes(x = factor(Gender), y = Salary, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Salary vs. Gender (USA)",
x = "Gender",
y = "Salary",
fill = "Gender") +
theme_minimal()
# Bibliothek ggplot2 laden
library(ggplot2)
# Daten für USA filtern
data_usa <- subset(filtered_data, Country == "USA")
# Boxplot erstellen
ggplot(data_usa, aes(x = factor(Gender), y = Years.Of.Experience, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Years of Experience vs. Gender (USA)",
x = "Gender",
y = "Years of Experience",
fill = "Gender") +
theme_minimal()
# Korrelation zwischen Salary und Years.Of.Experience berechnen
correlation_salary_experience <- cor(filtered_data$Salary, filtered_data$Years.Of.Experience)
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Salary und Years.Of.Experience ist:", correlation_salary_experience, "\n")
# Korrelation zwischen Salary und Education.Level berechnen
correlation_salary_education <- cor(filtered_data$Salary, filtered_data$Education.Level, use = "complete.obs")
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Salary und Education.Level ist:", correlation_salary_education, "\n")
# Korrelation zwischen Salary und Age berechnen
correlation_salary_age <- cor(filtered_data$Salary, filtered_data$Age, use = "complete.obs")
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Salary und Age ist:", correlation_salary_age, "\n")
# Korrelation zwischen Years.Of.Experience und Age berechnen
correlation_experience_age <- cor(filtered_data$Years.Of.Experience, filtered_data$Age, use = "complete.obs")
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Years.Of.Experience und Age ist:", correlation_experience_age, "\n")
# Annahme: "filtered_data" ist Ihr Datensatz
# Annahme: Die Spalten sind "Seniority" und "Years.Of.Experience"
# Korrelation zwischen Seniority und Years.Of.Experience berechnen
correlation_seniority_experience <- cor(filtered_data$Senior, filtered_data$Years.Of.Experience, use = "complete.obs")
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Seniority und Years.Of.Experience ist:", correlation_seniority_experience, "\n")
# Filtern der Daten für technische und administrative Jobs basierend auf den Kriterien
technische_jobs <- subset(filtered_data, job_type == 0)
admin_jobs <- subset(filtered_data, job_type == 1)
# Durchschnittliche Gehälter pro Jobtyp für technische Jobs berechnen
average_salaries_technical <- mean(technische_jobs$Salary, na.rm = TRUE)
# Durchschnittliche Gehälter pro Jobtyp für administrative Jobs berechnen
average_salaries_admin <- mean(admin_jobs$Salary, na.rm = TRUE)
# Zusammenführen der durchschnittlichen Gehälter in einem Datenrahmen
all_average_salaries <- data.frame(Job.Type = c("technisch", "admin"),
Average.Salary = c(average_salaries_technical, average_salaries_admin))
# Erstellung des Diagramms mit angepasster Achsenbeschriftung
ggplot(all_average_salaries, aes(x = Job.Type, y = Average.Salary, fill = Job.Type)) +
geom_bar(stat = "identity", position = "dodge", alpha = 0.7) +
labs(title = "Durchschnittliche Gehälter nach Jobtyp",
x = "Jobtyp",
y = "Durchschnittliches Gehalt") +
theme_minimal() +
scale_y_continuous(labels = scales::comma)  # Verwendung von scales::comma für die Achsenbeschriftung in Tausenden
# Erstellen der Spalte "Expat" basierend auf den angegebenen Kriterien
filtered_data$Expat <- 0  # Standardwert 0 (Einheimische)
# Festlegen von Bedingungen für Expats basierend auf Land und Ethnizität
expat_conditions <- list(
filtered_data$Race == "African American" & filtered_data$Country == "USA",
filtered_data$Race %in% c("White", "Chinese", "Australian", "Welsh") &
filtered_data$Country %in% c("Canada", "USA", "UK", "Australia"),
TRUE  # Für alle anderen Rassen (Expat)
)
# Setzen von Werten entsprechend den Bedingungen
filtered_data$Expat <- ifelse(expat_conditions[[1]] | expat_conditions[[2]], 0,
ifelse(expat_conditions[[3]], 1, NA))
# Anzeige des aktualisierten Datensatzes zur Überprüfung
head(filtered_data)
ggplot(filtered_data, aes(x = factor(Gender), y = Salary, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Salary vs. Gender",
x = "Gender",
y = "Salary",
fill = "Gender") +
theme_minimal()
library(tidyverse)
library(explore)
library(ggplot2)
library(corrplot)
library(dplyr)
salary <- read_csv("Salary.csv")
head(salary, 10)
describe_tbl(salary)
describe(salary)
salary <- salary |>
rename(
Job.Title = `Job Title`,
Years.Of.Experience = `Years of Experience`,
Education.Level = `Education Level`
)
explore (salary, Job.Title)
summary(salary)
Salary_long <- select(salary, -Job.Title, -Gender, -Race, -Country, -Senior)
Salary_long <- pivot_longer(Salary_long, colnames(Salary_long))
Salary <- as.data.frame(Salary_long)
head(Salary_long)
ggplot(Salary_long, aes(x = value)) +
geom_histogram() +
facet_wrap(~ name, scales = "free")
salary_final <- salary
hist(salary_final$Salary)
salary_final$SalaryKat <- cut(salary_final$Salary,
breaks = c(-Inf, 50000, 100000, 150000, 200000, 250000, Inf),                      labels = c("50000", "100000", "150000", "200000","250000", "300000"))
explore(salary_final, SalaryKat)
# Korrelation zwischen Salary und Years.Of.Experience berechnen
correlation_salary_experience <- cor(salary_final$Salary, salary_final$Years.Of.Experience)
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Salary und Years.Of.Experience ist:", correlation_salary_experience, "\n")
# Korrelation zwischen Salary und Age berechnen
correlation_salary_age <- cor(salary_final$Salary, salary_final$Age, use = "complete.obs")
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Salary und Age ist:", correlation_salary_age, "\n")
# Korrelation zwischen Years.Of.Experience und Age berechnen
correlation_experience_age <- cor(salary_final$Years.Of.Experience, salary_final$Age, use = "complete.obs")
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Years.Of.Experience und Age ist:", correlation_experience_age, "\n")
# Korrelation zwischen Seniority und Years.Of.Experience berechnen
correlation_seniority_experience <- cor(salary_final$Senior, salary_final$Years.Of.Experience, use = "complete.obs")
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Seniority und Years.Of.Experience ist:", correlation_seniority_experience, "\n")
correlations <- cor(salary_final[, c("Age", "Education.Level", "Years.Of.Experience", "Salary")])
print(correlations)
filtered_data_numeric <- select(salary, Salary, Age, Years.Of.Experience, Education.Level)
glimpse(filtered_data_numeric)
cor(filtered_data_numeric)
filtered_data_numeric |>
cor() |>
corrplot(method = 'ellipse')
ggplot(salary_final, aes(x = Years.Of.Experience, y = Salary)) +
geom_point(color = "blue", size = 3, shape = 16) +
labs(title = "Scatter Plot of Years of Experience vs Salary",
x = "Years of Experience",
y = "Salary")
ggplot(salary_final, aes(x = Education.Level, y = Salary)) +
geom_point(color = "blue", size = 3, shape = 16) +
labs(title = "Scatter Plot of Education Level vs Salary",
x = "Years of Experience",
y = "Salary")
ggplot(salary_final, aes(x = Race, y = Salary)) +
geom_bar(stat = "summary", fun = "mean", fill = "blue") +
labs(title = "Average Salary by Race",
x = "Race",
y = "Average Salary")
ggplot(salary_final, aes(x = Country, y = Salary, fill = Country)) +
geom_bar(stat = "summary", fun = "mean", position = "dodge", color = "black") +
labs(title = "Average Salary by Country",
x = "Country",
y = "Average Salary") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(salary_final, aes(x = Country, y = Salary, fill = Gender)) +
geom_bar(stat = "summary", fun = "mean", position = "stack", color = "black") +
labs(title = "Average Salary by Country and Gender",
x = "Country",
y = "Average Salary") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(salary_final, aes(x = Country, y = Salary, fill = factor(Education.Level))) +
geom_bar(stat = "summary", fun = "mean", position = "dodge", color = "black") +
labs(title = "Average Salary by Country and Education Level",
x = "Country",
y = "Average Salary") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(salary_final, aes(x = Country, y = Salary, fill = Race)) +
geom_bar(stat = "summary", fun = "mean", position = "stack", color = "black") +
labs(title = "Average Salary by Country and Race",
x = "Country",
y = "Average Salary") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(salary_final, aes(x = Job.Title, y = Salary)) +
geom_bar(stat = "summary", fun = "mean", fill = "blue", color = "black") +
labs(title = "Average Salary by Job Title",
x = "Job Title",
y = "Average Salary") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
job_title_count <- table(salary_final$Job.Title)
print(job_title_count)
job_title_count <- table(salary_final$Job.Title)
job_title_df <- data.frame(Job_Title = names(job_title_count), Frequency = as.numeric(job_title_count))
ggplot(job_title_df, aes(x = Job_Title, y = Frequency)) +
geom_bar(stat = "identity", fill = "blue", color = "black") +
labs(title = "Frequency of Unique Job Titles",
x = "Job Titles",
y = "Frequency") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(salary_final, aes(x = Country, y = Salary, fill = Race)) +
geom_boxplot() +
stat_summary(fun = "median", geom = "point", shape = 18, size = 3, color = "red", position = position_dodge(width = 0.75)) +
labs(title = "Salary Distribution by Country and Race",
x = "Country",
y = "Salary") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
filtered_data <- salary_final %>%
group_by(Job.Title) %>%
summarise(job_count = n()) %>%
filter(job_count > 30) %>%
inner_join(salary_final, by = "Job.Title")
print(filtered_data)
job_title_count <- table(filtered_data$Job.Title)
print(job_title_count)
job_title_count <- table(filtered_data$Job.Title)
job_title_df <- data.frame(Job_Title = names(job_title_count), Frequency = as.numeric(job_title_count))
ggplot(job_title_df, aes(x = Job_Title, y = Frequency)) +
geom_bar(stat = "identity", fill = "blue", color = "black") +
labs(title = "Frequency of Unique Job Titles",
x = "Job Titles",
y = "Frequency") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
job_title_count_filtered <- table(filtered_data$Job.Title)
cat(paste(names(job_title_count_filtered), ":", job_title_count_filtered, "\n"))
# Filtern nach technischen Jobs
technische_jobs <- filtered_data[grep("data|engineer|developer|analyst|scientist", tolower(filtered_data$Job.Title)), ]
# Filtern nach wirtschaftlichen/administrativen Jobs
admin_jobs <- filtered_data[grep("associate|director|manager|sales|coordinator|generalist|receptionist|designer", tolower(filtered_data$Job.Title)), ]
# Beispiel für die Ausgabe der ersten paar Zeilen der gefilterten Daten
head(technische_jobs)
head(admin_jobs)
# Anzahl der technischen Jobs
anzahl_technische_jobs <- nrow(technische_jobs)
cat("Anzahl der technischen Jobs:", anzahl_technische_jobs, "\n")
# Anzahl der administrativen Jobs
anzahl_admin_jobs <- nrow(admin_jobs)
cat("Anzahl der administrativen Jobs:", anzahl_admin_jobs, "\n")
# Anzahl der Zeilen (Werte) in filtered_data
anzahl_werte_filtered_data <- nrow(filtered_data)
# Anzeigen der Anzahl der Werte
cat("Anzahl der Werte in filtered_data:", anzahl_werte_filtered_data, "\n")
anzahl_jobs <- anzahl_technische_jobs + anzahl_admin_jobs
cat(anzahl_jobs)
# Add ID-Spalte
filtered_data$ID <- 1:nrow(filtered_data)
# Filtern nach technischen Jobs und Entfernen von Duplikaten
technische_jobs2 <- unique(filtered_data[grep("data|engineer|developer|analyst|scientist", tolower(filtered_data$Job.Title)), ])
# Filtern nach wirtschaftlichen/administrativen Jobs und Entfernen von Duplikaten
admin_jobs2 <- unique(filtered_data[grep("associate|director|manager|sales|coordinator|generalist|receptionist|designer", tolower(filtered_data$Job.Title)), ])
# Merke die IDs der übereinstimmenden Zeilen
ids_technische_jobs <- filtered_data$ID[filtered_data$Job.Title %in% technische_jobs2$Job.Title]
ids_admin_jobs <- filtered_data$ID[filtered_data$Job.Title %in% admin_jobs2$Job.Title]
# Entferne die entsprechenden Zeilen aus filtered_data
filtered_data_neu <- filtered_data[!(filtered_data$ID %in% c(ids_technische_jobs, ids_admin_jobs)), ]
# Beispiel für die Ausgabe der ersten paar Zeilen der gefilterten Daten
head(filtered_data_neu)
anzahl_technische_jobs2 <- nrow(technische_jobs2)
cat("Anzahl der technischen Jobs2:", anzahl_technische_jobs2, "\n")
anzahl_admin_jobs2 <- nrow(admin_jobs2)
cat("Anzahl der administrativen Jobs2:", anzahl_admin_jobs2, "\n")
# Erstellung der neuen Spalte "job_type" basierend auf den gegebenen Filtern
filtered_data$job_type <- ifelse(
grepl("data|engineer|developer|analyst|scientist", tolower(filtered_data$Job.Title)),
0, # 0 für technische Jobs
ifelse(
grepl("associate|director|manager|sales|coordinator|generalist", tolower(filtered_data$Job.Title)),
1, # 1 für administrative Jobs
NA  # NA für alle anderen
)
)
# Anzeige der Anzahl aller Zeilen im Datensatz und der Anzahl der Zeilen für jede job_type-Ausprägung
total_rows <- nrow(filtered_data)
count_job_types <- table(filtered_data$job_type, useNA = "ifany")
# Ausgabe der Ergebnisse
print(paste("Gesamtanzahl der Zeilen im Datensatz:", total_rows))
print("Anzahl der Zeilen für jede job_type-Ausprägung:")
print(count_job_types)
# Auswahl aller Zeilen mit NA-Werten in der Spalte "job_type"
na_job_type_rows <- subset(filtered_data, is.na(job_type))
# Anzeige der ausgewählten Zeilen mit NA in "job_type"
na_job_type_rows
# Aktualisierung der job_type-Spalte für die spezifischen Job-Titel
filtered_data$job_type[filtered_data$Job.Title %in% c("Product Designer", "Receptionist")] <- 1
# Anzeige der aktualisierten Daten für die ausgewählten Job-Titel
subset(filtered_data, Job.Title %in% c("Product Designer", "Receptionist"))
# Anzeige der Anzahl aller Zeilen im Datensatz und der Anzahl der Zeilen für jede job_type-Ausprägung
total_rows <- nrow(filtered_data)
count_job_types <- table(filtered_data$job_type, useNA = "ifany")
# Ausgabe der Ergebnisse
print(paste("Gesamtanzahl der Zeilen im Datensatz:", total_rows))
print("Anzahl der Zeilen für jede job_type-Ausprägung:")
print(count_job_types)
ggplot(filtered_data, aes(x = factor(Gender), y = Years.Of.Experience, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Years of Experience vs. Gender",
x = "Gender",
y = "Years of Experience",
fill = "Gender") +
theme_minimal()
# Bibliothek ggplot2 laden
library(ggplot2)
# Daten für China filtern
data_china <- subset(filtered_data, Country == "China")
# Boxplot erstellen
ggplot(data_china, aes(x = factor(Gender), y = Years.Of.Experience, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Years of Experience vs. Gender (China)",
x = "Gender",
y = "Years of Experience",
fill = "Gender") +
theme_minimal()
# Bibliothek ggplot2 laden
library(ggplot2)
# Daten für USA filtern
data_usa <- subset(filtered_data, Country == "USA")
# Boxplot erstellen
ggplot(data_usa, aes(x = factor(Gender), y = Years.Of.Experience, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Years of Experience vs. Gender (USA)",
x = "Gender",
y = "Years of Experience",
fill = "Gender") +
theme_minimal()
# Bibliothek ggplot2 laden
library(ggplot2)
# Daten für China filtern
data_china <- subset(filtered_data, Country == "China")
# Boxplot für Salary vs. Gender erstellen
ggplot(data_china, aes(x = factor(Gender), y = Salary, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Salary vs. Gender (China)",
x = "Gender",
y = "Salary",
fill = "Gender") +
theme_minimal()
# Bibliothek ggplot2 laden
library(ggplot2)
# Daten für USA filtern
data_usa <- subset(filtered_data, Country == "USA")
# Boxplot für Salary vs. Gender erstellen
ggplot(data_usa, aes(x = factor(Gender), y = Salary, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Salary vs. Gender (USA)",
x = "Gender",
y = "Salary",
fill = "Gender") +
theme_minimal()
# Korrelation zwischen Salary und Years.Of.Experience berechnen
correlation_salary_experience <- cor(filtered_data$Salary, filtered_data$Years.Of.Experience)
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Salary und Years.Of.Experience ist:", correlation_salary_experience, "\n")
# Korrelation zwischen Salary und Education.Level berechnen
correlation_salary_education <- cor(filtered_data$Salary, filtered_data$Education.Level, use = "complete.obs")
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Salary und Education.Level ist:", correlation_salary_education, "\n")
# Korrelation zwischen Salary und Age berechnen
correlation_salary_age <- cor(filtered_data$Salary, filtered_data$Age, use = "complete.obs")
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Salary und Age ist:", correlation_salary_age, "\n")
# Korrelation zwischen Years.Of.Experience und Age berechnen
correlation_experience_age <- cor(filtered_data$Years.Of.Experience, filtered_data$Age, use = "complete.obs")
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Years.Of.Experience und Age ist:", correlation_experience_age, "\n")
# Annahme: "filtered_data" ist Ihr Datensatz
# Annahme: Die Spalten sind "Seniority" und "Years.Of.Experience"
# Korrelation zwischen Seniority und Years.Of.Experience berechnen
correlation_seniority_experience <- cor(filtered_data$Senior, filtered_data$Years.Of.Experience, use = "complete.obs")
# Ausgabe des Ergebnisses
cat("Die Korrelation zwischen Seniority und Years.Of.Experience ist:", correlation_seniority_experience, "\n")
# Filtern der Daten für technische und administrative Jobs basierend auf den Kriterien
technische_jobs <- subset(filtered_data, job_type == 0)
admin_jobs <- subset(filtered_data, job_type == 1)
# Durchschnittliche Gehälter pro Jobtyp für technische Jobs berechnen
average_salaries_technical <- mean(technische_jobs$Salary, na.rm = TRUE)
# Durchschnittliche Gehälter pro Jobtyp für administrative Jobs berechnen
average_salaries_admin <- mean(admin_jobs$Salary, na.rm = TRUE)
# Zusammenführen der durchschnittlichen Gehälter in einem Datenrahmen
all_average_salaries <- data.frame(Job.Type = c("technisch", "admin"),
Average.Salary = c(average_salaries_technical, average_salaries_admin))
# Erstellung des Diagramms mit angepasster Achsenbeschriftung
ggplot(all_average_salaries, aes(x = Job.Type, y = Average.Salary, fill = Job.Type)) +
geom_bar(stat = "identity", position = "dodge", alpha = 0.7) +
labs(title = "Durchschnittliche Gehälter nach Jobtyp",
x = "Jobtyp",
y = "Durchschnittliches Gehalt") +
theme_minimal() +
scale_y_continuous(labels = scales::comma)  # Verwendung von scales::comma für die Achsenbeschriftung in Tausenden
ggplot(filtered_data, aes(x = Country, fill = Race)) +
geom_bar(position = "dodge") +
labs(title = "Count of Races in Each Country",
x = "Country",
y = "Count") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# Erstellen der Spalte "Expat" basierend auf den angegebenen Kriterien
filtered_data$Expat <- 0  # Standardwert 0 (Einheimische)
# Festlegen von Bedingungen für Expats basierend auf Land und Ethnizität
expat_conditions <- list(
filtered_data$Race == "African American" & filtered_data$Country == "USA",
filtered_data$Race %in% c("White", "Chinese", "Australian", "Welsh") &
filtered_data$Country %in% c("Canada", "USA", "UK", "Australia"),
TRUE  # Für alle anderen Rassen (Expat)
)
# Setzen von Werten entsprechend den Bedingungen
filtered_data$Expat <- ifelse(expat_conditions[[1]] | expat_conditions[[2]], 0,
ifelse(expat_conditions[[3]], 1, NA))
# Anzeige des aktualisierten Datensatzes zur Überprüfung
head(filtered_data)
ggplot(filtered_data, aes(x = factor(Gender), y = Salary, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Salary vs. Gender",
x = "Gender",
y = "Salary",
fill = "Gender") +
theme_minimal()
# Daten für USA filtern
data_usa <- subset(filtered_data, Country == "USA")
# Boxplot erstellen
ggplot(data_usa, aes(x = factor(Gender), y = Years.Of.Experience, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Years of Experience vs. Gender (USA)",
x = "Gender",
y = "Years of Experience",
fill = "Gender") +
theme_minimal()
# Daten für China filtern
data_china <- subset(filtered_data, Country == "China")
# Boxplot für Salary vs. Gender erstellen
ggplot(data_china, aes(x = factor(Gender), y = Salary, fill = Gender)) +
geom_boxplot(alpha = 0.7) +
labs(title = "Boxplot: Salary vs. Gender (China)",
x = "Gender",
y = "Salary",
fill = "Gender") +
theme_minimal()
